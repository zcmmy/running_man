<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=393, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>RunningMan - 校园跑腿</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    /* 使用系统字体 */
    body {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); /* 深色渐变背景 */
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative; /* 为装饰元素定位 */
    }
    /* 添加装饰元素 */
    body::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
        z-index: -1;
    }
    .iphone-frame {
      width: 410px;
      height: 885px;
      background: #000; /* 真实黑色边框 */
      border-radius: 40px;
      overflow: hidden;
      position: relative;
      box-shadow:
          inset 0 0 15px rgba(255, 255, 255, 0.1), /* 内部光泽 */
          inset 0 0 1px rgba(255, 255, 255, 0.2),
          0 0 0 1px rgba(255, 255, 255, 0.05), /* 细边框 */
          0 10px 30px rgba(0, 0, 0, 0.8); /* 外部阴影 */
    }
    .screen {
      width: 100%;
      height: 100%;
      background: #f2f2f7; /* iOS 灰白背景 */
      position: relative;
      overflow: hidden; /* 防止内部滚动影响 */
    }
    .safe-area {
      padding-top: 47px; /* 调整为 47px */
      height: 100%;
      background: #000; /* 仅顶部填充黑色 */
    }
    .page {
      display: none;
      height: calc(100% - 60px);
      overflow-y: auto; /* 确保可以滚动 */
      padding: 16px 14px 80px 14px; /* 调整 padding，恢复到原始值 */
      position: relative; /* 为返回按钮定位 */
      background: #f2f2f7; /* 确保页面内容背景色 */
    }
    .page.active {
      display: block;
    }
    /* 页面标题区域 (随页面滚动) - 高优先级页面 */
    .page-header {
        background: linear-gradient(to bottom, rgba(255, 165, 0, 0.95), rgba(255, 140, 0, 0.85)); /* 亮橙色背景 */
        padding: 12px 14px;
        margin: -16px -14px 12px -14px; /* 抵消 page 的 padding，并为下方内容留出空间 */
        border-bottom: 1px solid rgba(200, 100, 0, 0.2); /* 橙色系边框 */
        box-shadow: 0 2px 6px rgba(200, 100, 0, 0.15); /* 橙色系阴影 */
        backdrop-filter: blur(10px); /* 毛玻璃效果 */
        display: flex; /* 为搜索栏预留空间 */
        align-items: center;
    }
    .page-header h2 {
        flex: 1; /* 标题占据剩余空间 */
        color: #333; /* 标题文字颜色 */
    }
    /* 搜索栏 */
    .search-bar {
        background: white;
        border-radius: 10px;
        padding: 8px 16px;
        margin-left: 14px; /* 与页面边缘对齐 */
        display: flex;
        align-items: center;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        transition: transform 0.3s ease, opacity 0.3s ease; /* 平滑过渡 */
        flex: 1; /* 与标题一起布局 */
    }
    .search-bar.sticky-hidden {
        transform: translateY(-100%);
        opacity: 0;
    }
    .search-icon {
        width: 16px;
        height: 16px;
        margin-right: 8px;
        color: #8e8e93;
    }
    .search-input {
        flex: 1;
        border: none;
        outline: none;
        font-size: 14px;
        background: transparent;
        color: #333;
    }
    /* 通用返回按钮样式 */
    .back-btn {
      position: absolute;
      top: 47px + 12px; /* safe-area padding + top margin */
      left: 14px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px); /* 毛玻璃效果 */
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 11; /* 确保返回按钮在内容之上 */
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .back-btn svg {
        width: 16px;
        height: 16px;
        stroke: #007AFF; /* iOS 蓝色 */
        stroke-width: 3;
        fill: none;
    }
    /* 首页筛选菜单 */
    .filter-bar {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      background: white;
      border-radius: 12px;
      padding: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }
    .filter-select {
      flex: 1;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #f5f5f5;
      font-size: 12px;
    }
    /* 首页双列网格 */
    .grid-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .grid-item {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      cursor: pointer;
    }
    .item-image-container {
      width: 100%;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f5f5f7; /* 轻微背景色 */
    }
    .item-image {
      width: 80px;
      height: 80px;
      object-fit: contain; /* 保持图标比例 */
    }
    .item-content {
      padding: 12px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .item-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #333;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .item-desc {
      font-size: 12px;
      color: #888;
      flex: 1;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    .item-price {
      font-size: 14px;
      font-weight: bold;
      color: #FF6B35;
      margin-top: 4px;
    }
    .item-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      font-size: 11px;
      color: #aaa;
    }
    /* 卡片 (用于非首页) */
    .card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin: 10px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05); /* 更柔和的阴影 */
    }
    .card h3 {
      margin-bottom: 6px;
      font-size: 16px;
      font-weight: 600;
    }
    .card p {
      color: #666;
      font-size: 14px;
      line-height: 1.4;
    }
    /* 按钮 */
    .submit-btn {
      border: none;
      padding: 12px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      display: block;
      width: 100%;
      margin: 8px 0;
      text-align: center;
      font-size: 16px;
    }
    .btn-green {
      background: #4CAF50;
      color: #fff;
    }
    .btn-orange {
      background: #FF6B35;
      color: #fff;
    }
    .btn-blue {
      background: #007AFF;
      color: #fff;
    }
    /* 聊天消息 */
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px 16px 80px 16px; /* 增加底部填充，避免消息被输入框遮挡 */
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .message {
      max-width: 75%;
      padding: 10px 14px;
      border-radius: 18px;
      font-size: 15px;
    }
    .message-received {
      background: #E5E5EA;
      align-self: flex-start;
    }
    .message-sent {
      background: #007AFF;
      color: #fff;
      align-self: flex-end;
    }
    /* 输入区固定在底部 */
    .chat-input-area {
      position: absolute;
      bottom: 60px; /* 高度与导航栏一致 */
      left: 14px;
      right: 14px;
      display: flex;
      gap: 8px;
      align-items: center;
      padding: 8px 0; /* 增加上下 padding */
      background: #f2f2f7; /* 与页面背景一致 */
    }
    .chat-input {
      flex: 1;
      padding: 10px 12px;
      border-radius: 20px;
      border: 1px solid #d1d1d6;
      background: #fff;
      font-size: 16px;
    }
    .chat-send-btn {
      background: #007AFF;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
    }
    /* '我的' 页面 */
    .profile-header {
      background: white;
      border-radius: 12px;
      padding: 20px 16px;
      display: flex;
      align-items: center;
      margin-bottom: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #ccc; /* 占位头像 */
      margin-right: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: bold;
      font-size: 24px;
    }
    .user-info {
      flex: 1;
    }
    .user-name {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .user-id {
      font-size: 14px;
      color: #666;
    }
    .stats {
      display: flex;
      justify-content: space-around;
      margin-top: 16px;
    }
    .stat-item {
      text-align: center;
    }
    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #007AFF;
    }
    .stat-label {
      font-size: 12px;
      color: #666;
    }
    /* 消息页面地图 - 修改部分 */
    .map-container {
      height: 230px;
      border-radius: 16px;
      overflow: hidden;
      margin: 12px 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      position: relative;
    }
    .map {
      width: 100%;
      height: 100%;
      background: linear-gradient(#e0e0e0 1px, transparent 1px), 
                 linear-gradient(90deg, #e0e0e0 1px, transparent 1px);
      background-size: 20px 20px;
      position: relative;
    }
    .campus-map {
      position: absolute;
      width: 100%;
      height: 100%;
      background: 
        /* 校园建筑块 - 使用径向渐变模拟 */
        radial-gradient(circle at 25% 30%, #8B4513 0%, #8B4513 3%, transparent 3.5%),
        radial-gradient(circle at 35% 35%, #A9A9A9 0%, #A9A9A9 4%, transparent 4.5%),
        radial-gradient(circle at 45% 25%, #708090 0%, #708090 3.5%, transparent 4%),
        radial-gradient(circle at 55% 30%, #8B4513 0%, #8B4513 3%, transparent 3.5%),
        radial-gradient(circle at 65% 35%, #A9A9A9 0%, #A9A9A9 4%, transparent 4.5%),
        radial-gradient(circle at 75% 30%, #708090 0%, #708090 3.5%, transparent 4%),
        /* 校园绿地 - 使用径向渐变模拟 */
        radial-gradient(circle at 30% 60%, #2E8B57 0%, #3CB371 20%, transparent 25%),
        radial-gradient(circle at 70% 70%, #228B22 0%, #90EE90 20%, transparent 25%),
        /* 校园湖泊 - 使用径向渐变模拟 */
        radial-gradient(circle at 50% 85%, #1E90FF 0%, #87CEEB 20%, transparent 25%);
      opacity: 0.75; /* 调整透明度，使网格线更清晰可见 */
    }
    /* 原有的标记样式保持不变 */
    .map-marker {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 24px;
      height: 24px;
      background: #FF6B35;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .map-marker-runner {
      position: absolute;
      /* 初始位置 */
      top: 30%;
      left: 30%;
      width: 18px;
      height: 18px;
      background: #007AFF;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      /* 动画 */
      transition: left 1s ease-in-out, top 1s ease-in-out; /* 平滑过渡 */
    }
    /* 底部导航 */
    .nav {
      position: absolute;
      bottom: 0;
      width: 100%;
      display: flex;
      background: #ffffff; /* iOS 导航栏白色 */
      height: 60px;
      box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.05); /* 细分隔线 */
      z-index: 20; /* 确保导航栏在最顶层 */
    }
    .nav-btn {
      flex: 1;
      text-align: center;
      cursor: pointer;
      font-size: 12px;
      color: #8e8e93; /* iOS 默认颜色 */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .nav-btn.active {
      color: #007AFF; /* 使用 iOS 蓝色 */
      font-weight: 600;
    }
    .nav-icon {
      width: 22px;
      height: 22px;
      margin-bottom: 4px;
    }
    .nav-icon svg {
      width: 100%;
      height: 100%;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
    }
  </style>
</head>
<body>
  <!-- 参考模拟声明 -->
<div style="
  position: absolute;
  bottom: 10px;
  right: 10px;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
  background: rgba(0, 0, 0, 0.3);
  padding: 4px 8px;
  border-radius: 4px;
  z-index: 100; /* 确保声明在最顶层 */
  pointer-events: none; /* 防止声明遮挡交互 */
">
  仅供参考模拟，非最终落地方案效果
</div>
  <div class="iphone-frame">
    <div class="screen">
      <div class="safe-area">
        <!-- 首页 -->
        <div id="home" class="page active">
            <div class="page-header">
                <h2>推荐任务</h2>
                <!-- 搜索栏 -->
                <div class="search-bar" id="searchBar">
                    <svg class="search-icon" viewBox="0 0 24 24"><path d="M11 17.5a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13zm0 1.5a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"/><path d="m16.5 16.5 4 4"/></svg>
                    <input class="search-input" type="text" placeholder="搜索跑腿任务...">
                </div>
            </div>
          <!-- 筛选菜单 -->
          <div class="filter-bar">
            <select class="filter-select">
              <option>位置</option>
              <option>校门口</option>
              <option>图书馆</option>
              <option>教学楼</option>
              <option>宿舍区</option>
            </select>
            <select class="filter-select">
              <option>时间</option>
              <option>1小时内</option>
              <option>2小时内</option>
              <option>不限</option>
            </select>
            <select class="filter-select">
              <option>类型</option>
              <option>外卖</option>
              <option>快递</option>
              <option>打印</option>
              <option>其他</option>
            </select>
          </div>
          <!-- 任务列表 -->
          <div class="grid-container">
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF6B35'%3E%3Cpath d='M18 10V8H6v2h12zm0 2v2H6v-2h12zm0 4v2H6v-2h12z'/%3E%3Cpath d='M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-1 16H6V5h12v14z'/%3E%3C/svg%3E" alt="外卖图标">
              </div>
              <div class="item-content">
                <div class="item-title">麦当劳大套餐</div>
                <div class="item-desc">校门口取餐，送至图书馆三楼 A301</div>
                <div class="item-price">¥15</div>
                <div class="item-meta">
                  <span>已发布</span>
                  <span>2km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%234CAF50'%3E%3Cpath d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12H4v-2h8v2zm4-3H4v-2h12v2zm0-3H4V8h12v2z'/%3E%3C/svg%3E" alt="文档图标">
              </div>
              <div class="item-content">
                <div class="item-title">打印 20 页文档</div>
                <div class="item-desc">打印店取 20 页文件，送至教学楼 502</div>
                <div class="item-price">¥8</div>
                <div class="item-meta">
                  <span>进行中</span>
                  <span>1km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232196F3'%3E%3Cpath d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8.83l7.03 4.02c.07.04.15.04.22 0L19 8.83V19zm0-11.61l-6.5 3.71L5 6.39V5h14v1.39z'/%3E%3C/svg%3E" alt="包裹图标">
              </div>
              <div class="item-content">
                <div class="item-title">取快递</div>
                <div class="item-desc">韵达快递，收件人：小明</div>
                <div class="item-price">¥5</div>
                <div class="item-meta">
                  <span>已发布</span>
                  <span>0.5km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%239C27B0'%3E%3Cpath d='M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5z'/%3E%3C/svg%3E" alt="药品图标">
              </div>
              <div class="item-content">
                <div class="item-title">买感冒药</div>
                <div class="item-desc">校医院取感冒药，送至宿舍</div>
                <div class="item-price">¥25</div>
                <div class="item-meta">
                  <span>待接单</span>
                  <span>1.5km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF9800'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z'/%3E%3C/svg%3E" alt="包裹图标">
              </div>
              <div class="item-content">
                <div class="item-title">取中通快递</div>
                <div class="item-desc">取中通快递，收件人：李华</div>
                <div class="item-price">¥6</div>
                <div class="item-meta">
                  <span>已发布</span>
                  <span>0.8km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23E91E63'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E" alt="饮料图标">
              </div>
              <div class="item-content">
                <div class="item-title">买冰可乐</div>
                <div class="item-desc">超市买一瓶冰可乐，送到操场</div>
                <div class="item-price">¥4</div>
                <div class="item-meta">
                  <span>待接单</span>
                  <span>1.2km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%234CAF50'%3E%3Cpath d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 12H4v-2h8v2zm4-3H4v-2h12v2zm0-3H4V8h12v2z'/%3E%3C/svg%3E" alt="文档图标">
              </div>
              <div class="item-content">
                <div class="item-title">打印简历</div>
                <div class="item-desc">打印店取 5 份简历，送至宿舍</div>
                <div class="item-price">¥10</div>
                <div class="item-meta">
                  <span>已发布</span>
                  <span>0.3km</span>
                </div>
              </div>
            </div>
            <div class="grid-item" data-target="detail">
              <div class="item-image-container">
                  <img class="item-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23FF5722'%3E%3Cpath d='M18 10V8H6v2h12zm0 2v2H6v-2h12zm0 4v2H6v-2h12z'/%3E%3Cpath d='M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-1 16H6V5h12v14z'/%3E%3C/svg%3E" alt="零食图标">
              </div>
              <div class="item-content">
                <div class="item-title">买薯片和可乐</div>
                <div class="item-desc">小卖部买零食，送到宿舍</div>
                <div class="item-price">¥12</div>
                <div class="item-meta">
                  <span>进行中</span>
                  <span>0.1km</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 发布 -->
        <div id="post" class="page">
            <div class="page-header">
                <h2>发布订单</h2>
            </div>
          <div class="card">
            <h3>快速发布</h3>
            <p>一键填写常用跑腿任务，省时高效。</p>
          </div>
          <div class="card">
            <h3>自定义发布</h3>
            <p>手动填写订单内容，更加灵活。</p>
          </div>
          <button class="submit-btn btn-green">立即发布</button>
        </div>
        <!-- 消息 -->
        <div id="messages" class="page">
            <div class="page-header">
                <h2>我的消息</h2>
            </div>
          <div class="card">
            <h3>跑腿员：张同学</h3>
            <p>正在送餐（预计 10 分钟后送达）</p>
            <!-- 地图容器 -->
            <div class="map-container">
              <div class="map">
                <div class="campus-map"></div>
              </div>
              <div class="map-marker"></div>
              <div class="map-marker-runner" id="runnerMarker"></div>
            </div>
            <button class="submit-btn btn-green" data-target="order-tracking">查看订单详情</button>
            <button class="submit-btn btn-green" data-target="chat">联系跑腿员</button>
          </div>
          <div class="card">
            <h3>系统通知</h3>
            <p>您的订单 #20250929 已完成</p>
          </div>
        </div>
        <!-- 我的 -->
        <div id="profile" class="page">
            <div class="page-header">
                <h2>个人中心</h2>
            </div>
          <div class="profile-header">
            <div class="avatar">明</div>
            <div class="user-info">
              <div class="user-name">小明</div>
              <div class="user-id">学号: 20230001</div>
            </div>
          </div>
          <div class="stats">
            <div class="stat-item">
              <div class="stat-value">8</div>
              <div class="stat-label">总订单</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">85</div>
              <div class="stat-label">总收入 (元)</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">4.8</div>
              <div class="stat-label">信用分</div>
            </div>
          </div>
          <div class="card">
            <h3>设置</h3>
            <p>账户安全、通知设置等</p>
          </div>
          <div class="card">
            <h3>帮助与反馈</h3>
            <p>使用指南、联系客服</p>
          </div>
        </div>
        <!-- 商品详情 -->
        <div id="detail" class="page">
          <div class="back-btn js-back">
            <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          </div>
          <h2 style="text-align: center; margin-bottom: 12px;">任务详情</h2>
          <div class="card">
            <h3>外卖代取 - 麦当劳</h3>
            <p>地点：学校南门<br>价格：¥15<br>备注：请快点送，我在图书馆三楼 A301</p>
          </div>
          <div class="card">
            <h3>任务信息</h3>
            <p>距离：2km<br>类型：外卖代取<br>发布时间：10分钟前</p>
          </div>
          <button class="submit-btn btn-green">立即接单</button>
        </div>
        <!-- 订单详情 -->
        <div id="order-tracking" class="page">
          <div class="back-btn js-back">
            <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          </div>
          <h2 style="text-align: center; margin-bottom: 12px;">订单详情</h2>
          <div class="card">
            <h3>订单号 #20250928</h3>
            <p>状态：进行中<br>预计送达：10 分钟后<br>跑腿员：张同学</p>
          </div>
          <div class="card">
            <h3>任务信息</h3>
            <p>外卖代取 - 麦当劳<br>地点：学校南门 -> 图书馆三楼 A301</p>
          </div>
        </div>
        <!-- 聊天详情 -->
        <div id="chat" class="page">
          <div class="back-btn js-back">
            <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          </div>
          <h2 style="text-align: center; margin-bottom: 12px;">聊天记录</h2>
          <div class="chat-messages">
            <div class="message message-received">跑腿员：我快到校门口了。</div>
            <div class="message message-sent">您：好的，我下去取。</div>
            <div class="message message-received">跑腿员：大约 5 分钟。</div>
          </div>
          <!-- 输入区固定在页面底部 -->
          <div class="chat-input-area">
            <input class="chat-input" placeholder="输入消息（预览不可用）" />
            <div class="chat-send-btn">➤</div>
          </div>
        </div>
        <!-- 底部导航 -->
        <div class="nav">
          <div class="nav-btn active" data-page="home">
            <div class="nav-icon">
              <svg viewBox="0 0 24 24"><path d="M3 9.5L12 3l9 6.5V21a1 1 0 0 1-1 1h-6v-6H10v6H4a1 1 0 0 1-1-1V9.5z"/></svg>
            </div>
            <div>首页</div>
          </div>
          <div class="nav-btn" data-page="post">
            <div class="nav-icon">
              <svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg>
            </div>
            <div>发布</div>
          </div>
          <div class="nav-btn" data-page="messages">
            <div class="nav-icon">
              <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </div>
            <div>信息</div>
          </div>
          <div class="nav-btn" data-page="profile">
            <div class="nav-icon">
              <svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-5.33 0-8 2.67-8 5v3h16v-3c0-2.33-2.67-5-8-5z"/></svg>
            </div>
            <div>我的</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function(){
      const pages = document.querySelectorAll('.page');
      const navBtns = document.querySelectorAll('.nav-btn');
      const targetBtns = document.querySelectorAll('[data-target]');
      const backBtns = document.querySelectorAll('.js-back');
      const HIGH_PAGES = ['home','post','messages','profile'];
      let stack = ['home'];
      function showPage(pageId, {replace=false, clear=false}={}) {
        if(!pageId) return;
        if(HIGH_PAGES.includes(pageId) || clear) {
          stack = [pageId];
        } else {
          if(replace) { stack[stack.length-1] = pageId; }
          else { stack.push(pageId); }
        }
        pages.forEach(p => p.classList.toggle('active', p.id === pageId));
        navBtns.forEach(btn => btn.classList.toggle('active', btn.dataset.page === pageId));
      }
      function goBack() {
        if(stack.length > 1) {
          stack.pop();
          showPage(stack[stack.length-1], {replace: true});
        } else {
          showPage('home', {clear: true});
        }
      }
      // 导航栏（最高优先级）
      navBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          showPage(btn.dataset.page, {clear: true});
        });
      });
      // 普通按钮跳转（低优先级）
      targetBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          showPage(btn.dataset.target);
        });
      });
      // 返回按钮
      backBtns.forEach(btn => {
        btn.addEventListener('click', goBack);
      });
      // --- 新增：模拟地图位置更新 ---
      const runnerMarker = document.getElementById('runnerMarker');
      let pos = { x: 30, y: 30 }; // 初始百分比位置
      const targetPos = { x: 70, y: 60 }; // 目标百分比位置 (目的地附近)
      // 模拟位置更新函数
      function updateRunnerPosition() {
          // 简单的线性插值，让跑腿员向目标移动
          if (pos.x < targetPos.x) pos.x += 0.5;
          if (pos.y < targetPos.y) pos.y += 0.3;
          // 应用新位置到样式
          runnerMarker.style.left = `${pos.x}%`;
          runnerMarker.style.top = `${pos.y}%`;
          // 如果还没到达，继续更新
          if (pos.x < targetPos.x || pos.y < targetPos.y) {
              requestAnimationFrame(updateRunnerPosition); // 使用 requestAnimationFrame 平滑更新
          }
      }
      // 当切换到消息页面时，启动模拟
      const messagesPage = document.getElementById('messages');
      const observer = new MutationObserver((mutationsList) => {
          for (let mutation of mutationsList) {
              if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                  if (messagesPage.classList.contains('active')) {
                      // 重置位置
                      pos = { x: 30, y: 30 };
                      runnerMarker.style.left = `${pos.x}%`;
                      runnerMarker.style.top = `${pos.y}%`;
                      // 开始模拟移动
                      setTimeout(updateRunnerPosition, 1000); // 延迟1秒开始，更自然
                  }
              }
          }
      });
      observer.observe(messagesPage, { attributes: true });
      // 初始启动一次模拟（如果消息页是默认激活的）
      if (messagesPage.classList.contains('active')) {
          setTimeout(updateRunnerPosition, 1000);
      }
      // --- 新增结束 ---
      // --- 新增：首页搜索栏滚动效果 ---
      const searchBar = document.getElementById('searchBar');
      let lastScrollTop = 0;
      let isSearchBarVisible = true;
      document.getElementById('home').addEventListener('scroll', function() {
          const scrollTop = this.scrollTop;
          if (scrollTop > lastScrollTop && scrollTop > 50) {
              // 向下滚动且超过一定距离，隐藏搜索栏
              if (isSearchBarVisible) {
                  searchBar.classList.add('sticky-hidden');
                  isSearchBarVisible = false;
              }
          } else {
              // 向上滚动，显示搜索栏
              if (!isSearchBarVisible) {
                  searchBar.classList.remove('sticky-hidden');
                  isSearchBarVisible = true;
              }
          }
          lastScrollTop = scrollTop;
      });
      // --- 新增结束 ---
    })();
  </script>
</body>
</html>